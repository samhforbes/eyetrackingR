<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating time windows of divergence • eyetrackingR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating time windows of divergence">
<meta property="og:description" content="eyetrackingR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eyetrackingR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/divergence_vignette.html">Estimating time windows of divergence</a>
    </li>
    <li>
      <a href="../articles/growth_curve_analysis_vignette.html">Performing a growth curve analysis using eyetrackingR</a>
    </li>
    <li>
      <a href="../articles/onset_contingent_analysis_vignette.html">Performing an onset-contingent analysis using eyetrackingR</a>
    </li>
    <li>
      <a href="../articles/preparing_your_data_vignette.html">Preparing your data for use with eyetrackingR</a>
    </li>
    <li>
      <a href="../articles/window_analysis_vignette.html">Performing a window analysis using eyetrackingR</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/samhforbes/eyetrackingR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating time windows of divergence</h1>
                        <h4 data-toc-skip class="author">Samuel Forbes,
Jacob Dink &amp; Brock Ferguson</h4>
            
            <h4 data-toc-skip class="date">2023-09-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/samhforbes/eyetrackingR/blob/HEAD/vignettes/divergence_vignette.Rmd" class="external-link"><code>vignettes/divergence_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>divergence_vignette.Rmd</code></div>

    </div>

    
    
<blockquote>
<p><strong>Our Experiment</strong>: Each eyetrackingR vignette uses the
<em>eyetrackingR</em> package to analyze real data from a simple
2-alternative forced choice (2AFC) word recognition task administered to
19- and 24-month-olds. On each trial, infants were shown a picture of an
animate object (e.g., a horse) and an inanimate object (e.g., a spoon).
After inspecting the images, they disappeared and they heard a label
referring to one of them (e.g., “The horse is nearby!”). Finally, the
objects re-appeared on the screen and they were prompted to look at the
target (e.g., “Look at the horse!”).</p>
</blockquote>
<div class="section level2">
<h2 id="overview-of-this-vignette">Overview of this vignette<a class="anchor" aria-label="anchor" href="#overview-of-this-vignette"></a>
</h2>
<p>In this vignette, we want to ascertain when a predictor had a
significant effect during a trial. Analyses that aggregate over the
trial window tell us <em>whether</em> an effect was significant, growth
curve analyses tell us the trajectory of our effect over the course of
the trial, and onset-contingent analyses can tell you reaction times for
certain experimental designs. But none of these approaches allow you to
ask: What is the onset of some predictor’s effect, and how long does the
effect last? eyetrackingR includes two types of analyses for answering
these questions, both of which we cover here.</p>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>Before performing this analysis, we’ll need to prepare and clean our
dataset. Here we will to do this quickly and with few notes but, for
more information, see the vignette on <a href="preparing_your_data_vignette.html">preparing your data</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://Matrix.R-forge.R-project.org" class="external-link">"Matrix"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lme4/lme4/" class="external-link">"lme4"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://samforbes.me/eyetrackingR/" class="external-link">"eyetrackingR"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: dplyr</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"word_recognition"</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_eyetrackingr_data.html">make_eyetrackingr_data</a></span><span class="op">(</span><span class="va">word_recognition</span>, </span>
<span>                       participant_column <span class="op">=</span> <span class="st">"ParticipantName"</span>,</span>
<span>                       trial_column <span class="op">=</span> <span class="st">"Trial"</span>,</span>
<span>                       time_column <span class="op">=</span> <span class="st">"TimeFromTrialOnset"</span>,</span>
<span>                       trackloss_column <span class="op">=</span> <span class="st">"TrackLoss"</span>,</span>
<span>                       aoi_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Animate'</span>,<span class="st">'Inanimate'</span><span class="op">)</span>,</span>
<span>                       treat_non_aoi_looks_as_missing <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                <span class="op">)</span></span>
<span></span>
<span><span class="co"># subset to response window post word-onset</span></span>
<span><span class="va">response_window</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_by_window.html">subset_by_window</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                                    window_start_time <span class="op">=</span> <span class="fl">15500</span>, </span>
<span>                                    window_end_time <span class="op">=</span> <span class="fl">21000</span>, </span>
<span>                                    rezero <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Avg. window length in new data will be 5500</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># analyze amount of trackloss by subjects and trials</span></span>
<span><span class="op">(</span><span class="va">trackloss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trackloss_analysis.html">trackloss_analysis</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">response_window</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove trials with &gt; 25% of trackloss</span></span>
<span><span class="va">response_window_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_by_trackloss.html">clean_by_trackloss</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">response_window</span>,</span>
<span>                                            trial_prop_thresh <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Performing Trackloss Analysis...</span></span></code></pre>
<pre><code><span><span class="co">## Will exclude trials whose trackloss proportion is greater than : 0.25</span></span></code></pre>
<pre><code><span><span class="co">##  ...removed  33  trials.</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create Target condition column</span></span>
<span><span class="va">response_window_clean</span><span class="op">$</span><span class="va">Target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span>test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'(Spoon|Bottle)'</span>, <span class="va">response_window_clean</span><span class="op">$</span><span class="va">Trial</span><span class="op">)</span>, </span>
<span>                                       yes <span class="op">=</span> <span class="st">'Inanimate'</span>, </span>
<span>                                       no  <span class="op">=</span> <span class="st">'Animate'</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p>To begin, we need to use <code>make_time_sequence_data</code> to
generate a time-binned dataframe. We’ll summarize by subjects for
now.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_time_sequence_data.html">make_time_sequence_data</a></span><span class="op">(</span><span class="va">response_window_clean</span>,</span>
<span>                                  time_bin_size <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                                  predictor_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Target"</span><span class="op">)</span>,</span>
<span>                                  aois <span class="op">=</span> <span class="st">"Animate"</span>,</span>
<span>                                  summarize_by <span class="op">=</span> <span class="st">"ParticipantName"</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize timecourse</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">response_time</span>, predictor_column <span class="op">=</span> <span class="st">"Target"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="divergence_vignette_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="testing-time-bins-independently">Testing Time-Bins Independently<a class="anchor" aria-label="anchor" href="#testing-time-bins-independently"></a>
</h2>
<p>One straightforward method of testing for divergences is simply to
perform a statistical test on each time-bin separately. This method is
problematic, but walking through it and explaining why will help set up
other methods.</p>
<p>EyetrackingR provides <code>analyze_time_bins</code>, a function that
makes sequential tests like this easy to implement.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_time_bins.html">analyze_time_bins</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">response_time</span>, predictor_column <span class="op">=</span> <span class="st">"Target"</span>, test <span class="op">=</span> <span class="st">"t.test"</span>, alpha <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Computing t.test for each time bin...</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tb_analysis</span>, type <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divergence_vignette_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tb_analysis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Test Type:    t.test </span></span>
<span><span class="co">## Predictor:    Target </span></span>
<span><span class="co">## Formula:  Prop ~ Target </span></span>
<span><span class="co">## Runs of Significant Time Bins: </span></span>
<span><span class="co">## Positive Run 1  ===== </span></span>
<span><span class="co">##  Time:        16100 - 19300 </span></span>
<span><span class="co">## Positive Run 2  ===== </span></span>
<span><span class="co">##  Time:        19400 - 21000</span></span></code></pre>
<p>This method suggests that looking diverges across conditions as early
as 16100. However, this method does not control the family-wise error
rate–that is, the probability of finding at least one divergence across
conditions where none actually exists. Because we are performing so many
tests, we are bound to get <em>some</em> statistically significant
results, even if no effect is actually present. If there is no real
effect, if each test is completely independent, and if our alpha for
each test is .05, then the odds of at least one false alarm is…</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">.05</span></span>
<span><span class="va">num_time_bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tb_analysis</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">prob_no_false_alarm_per_bin</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.95</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">prob_no_false_alarm_any_bin</span> <span class="op">&lt;-</span> <span class="va">prob_no_false_alarm_per_bin</span><span class="op">^</span><span class="va">num_time_bins</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.05953856</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">prob_at_least_one_false_alarm</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="va">prob_no_false_alarm_any_bin</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9404614</span></span></code></pre>
<p>…almost 95%! Of course, two of the assumptions I described above
aren’t met: the independence assumption isn’t met (clearly a given
time-bin should be similar to its neighboring time-bins), and the “no
real effect” assumption probably isn’t met (given the analyses in the
other vignettes). But we still need to control for family-wise error
rate.</p>
<p>One approach is a bonferroni correction. If we simply lower our alpha
according to the number of time-bins, then the family-wise error rate
goes back down:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">.05</span> <span class="op">/</span> <span class="va">num_time_bins</span></span>
<span><span class="op">(</span><span class="va">prob_no_false_alarm_per_bin</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9990909</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">prob_no_false_alarm_any_bin</span> <span class="op">&lt;-</span> <span class="va">prob_no_false_alarm_per_bin</span><span class="op">^</span><span class="va">num_time_bins</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9512078</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">prob_at_least_one_false_alarm</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="va">prob_no_false_alarm_any_bin</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.04879221</span></span></code></pre>
<p>We apply this correction by using the
<code>p_adjust_method</code>:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb_analysis_bonf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_time_bins.html">analyze_time_bins</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">response_time</span>, predictor_column <span class="op">=</span> <span class="st">"Target"</span>, test <span class="op">=</span> <span class="st">"t.test"</span>, alpha <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>                                 p_adjust_method <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Computing t.test for each time bin...</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tb_analysis_bonf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divergence_vignette_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tb_analysis_bonf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Test Type:    t.test </span></span>
<span><span class="co">## Predictor:    Target </span></span>
<span><span class="co">## Formula:  Prop ~ Target </span></span>
<span><span class="co">## Runs of Significant Time Bins: </span></span>
<span><span class="co">## Positive Run 1  ===== </span></span>
<span><span class="co">##  Time:        16300 - 17800 </span></span>
<span><span class="co">## Positive Run 2  ===== </span></span>
<span><span class="co">##  Time:        18100 - 18500 </span></span>
<span><span class="co">## Positive Run 3  ===== </span></span>
<span><span class="co">##  Time:        20600 - 20800</span></span></code></pre>
<p>This method seems overly conservative, and indeed it is: this
correction assumes the ‘worst case scenario’ that all time-bins are
fully independent– which as we mentioned, is clearly not the case. Other
methods are less stringent. Any method available in R’s
<code>p.adjust</code> function are available to
<code>analyze_time_bins</code>. See the documentation of that function
for more details. As mentioned there, there isn’t really a good reason
to use the Bonferroni method, because Holm’s method controls family-wise
error just as well, but sometimes is more powerful:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb_analysis_holm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_time_bins.html">analyze_time_bins</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">response_time</span>, predictor_column <span class="op">=</span> <span class="st">"Target"</span>, test <span class="op">=</span> <span class="st">"t.test"</span>, alpha <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>                                 p_adjust_method <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Computing t.test for each time bin...</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tb_analysis_holm</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divergence_vignette_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tb_analysis_holm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Test Type:    t.test </span></span>
<span><span class="co">## Predictor:    Target </span></span>
<span><span class="co">## Formula:  Prop ~ Target </span></span>
<span><span class="co">## Runs of Significant Time Bins: </span></span>
<span><span class="co">## Positive Run 1  ===== </span></span>
<span><span class="co">##  Time:        16300 - 18500 </span></span>
<span><span class="co">## Positive Run 2  ===== </span></span>
<span><span class="co">##  Time:        20600 - 20800</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="bootstrapped-smoothed-divergence-analysis">Bootstrapped smoothed divergence analysis<a class="anchor" aria-label="anchor" href="#bootstrapped-smoothed-divergence-analysis"></a>
</h2>
<p>One concern with multiple-testing using corrections is that it
severely limits our power: by controlling the family-wise error rate, we
sacrifice our ability to detect effects when they are present.</p>
<p>In fact, even the uncorrected, overly liberal test seems to have made
a small error in the conservative direction: it split our runs of
statistically significant time-bins in two, due to a small downward blip
in one of the time-bins. It seems unlikely the effect actually vanished
for this single time bin: instead, it seems more likely that
eye-tracking data is noisy, and that we should try to ignore the small
variations that are a result of this noise.</p>
<p>One approach is to perform a statistical test that operates over a
smoothed version of our data (similar to Wendt et al., 2014). This
involves:</p>
<ol style="list-style-type: decimal">
<li>Resampling with replacement from our data (e.g., randomly resampling
subjects from each condition).</li>
<li>For each resample, fitting a smoothing curve to the data (choosing
either <code><a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline()</a></code>, <code><a href="https://rdrr.io/r/stats/loess.html" class="external-link">loess()</a></code>, or no
smoother)</li>
<li>Repeating steps (1) and (2) thousands of times to generate a
distribution,</li>
<li>Obtain the 95% confidence intervals of this distribution. Those
time-bins whose confidence intervals do not overlap with zero can be
considered statistically significant at alpha = .05.</li>
</ol>
<p>This is a useful technique for estimating the timepoints of
divergence between two conditions, while the smoothing helps remove
minor deviations that might disrupt what would otherwise be considered a
single divergent period. This can be especially helpful in infant data,
which can be extremely noisy. Note that this approach can only deal with
testing differences across two levels of a predictor (e.g., an
experimental manipulation, not a continous covariate).</p>
<p>This method returns a list of divergences between your two conditions
based on time windows in which (by default) the 95% confidence intervals
did not include 0 (i.e., <em>p</em> &lt; .05).</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb_bootstrap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_time_bins.html">analyze_time_bins</a></span><span class="op">(</span><span class="va">response_time</span>, predictor_column <span class="op">=</span> <span class="st">'Target'</span>, test<span class="op">=</span> <span class="st">'boot_splines'</span>, </span>
<span>                                  within_subj <span class="op">=</span> <span class="cn">TRUE</span>, bs_samples <span class="op">=</span> <span class="fl">1000</span>, alpha <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tb_bootstrap</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divergence_vignette_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tb_bootstrap</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Test Type:    boot_splines </span></span>
<span><span class="co">## Predictor:    Target </span></span>
<span><span class="co">## Formula:  Prop ~ Target </span></span>
<span><span class="co">## Runs of Significant Time Bins: </span></span>
<span><span class="co">## Positive Run 1  ===== </span></span>
<span><span class="co">##  Time:        15900 - 21000</span></span></code></pre>
<p>We can see that this method (probably correctly) identified that our
trial involves a single divergence in looking across conditions, rather
than two divergences separated by a single time-bin.</p>
<p>However, it is important to note that this method doesn’t explicitly
control the family-wise error rate. And unfortunately, because this test
doesn’t produce a p-value for each bin, we can only perform a (manual)
Bonferroni-correction.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tb_bootstrap_bonf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_time_bins.html">analyze_time_bins</a></span><span class="op">(</span><span class="va">response_time</span>, predictor_column <span class="op">=</span> <span class="st">'Target'</span>, test<span class="op">=</span> <span class="st">'boot_splines'</span>, </span>
<span>                                  within_subj <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">.05</span><span class="op">/</span><span class="va">num_time_bins</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tb_bootstrap_bonf</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divergence_vignette_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tb_bootstrap_bonf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Test Type:    boot_splines </span></span>
<span><span class="co">## Predictor:    Target </span></span>
<span><span class="co">## Formula:  Prop ~ Target </span></span>
<span><span class="co">## Runs of Significant Time Bins: </span></span>
<span><span class="co">## Positive Run 1  ===== </span></span>
<span><span class="co">##  Time:        16100 - 18900 </span></span>
<span><span class="co">## Positive Run 2  ===== </span></span>
<span><span class="co">##  Time:        19600 - 20600</span></span></code></pre>
<p>Once correcting, the test suffers from many of the same problems as
the Bonferroni t-tests.</p>
</div>
<div class="section level2">
<h2 id="bootstrapped-cluster-based-permutation-analysis">Bootstrapped cluster-based permutation analysis<a class="anchor" aria-label="anchor" href="#bootstrapped-cluster-based-permutation-analysis"></a>
</h2>
<p>Above we saw problems both with false-alarms and sensitivity. This is
not a zero-sum game. One approach that offers an excellent compromise
between the two is referred to as a cluster-based permutation analysis
(Maris &amp; Oostenveld, 2007).</p>
<p>This procedure involves two main steps. First, we run a test on each
time bin that quantifies the statistical significance of the effect at
each time bin. This acts as a “first pass,” and we group together into
clusters all adjacent bins that get through this first pass. We then
shuffle the data, performing this test-then-cluster on each iteration of
the shuffled data. This shuffled data tells us what kinds of clusters we
should expect if there were no effect (i.e., randomly scrambled
data).</p>
<hr>
<p>In more detail, what eyetrackingR does is:</p>
<ol style="list-style-type: decimal">
<li>Run a statistical test on each time-bin of your data. This can be
any valid and appropriate statistic that quantifies the probability of
the data under the null hypothesis: t-test, wilcox.test, linear models,
etc.– whatever is appropriate for your data.</li>
<li>Take the time-bins whose test passed the threshold statistic (e.g.,
t &gt; 2), and group them by adjacency. We will call these
time-clusters.</li>
<li>For each time-cluster, calculate the sum of the statistics for the
time-bins inside it.</li>
<li>Take the data and randomly shuffle it.</li>
<li>Perform (1)-(3) on the shuffled dataset. Save the biggest
sum-statistic.</li>
<li>Repeat steps (4) and (5) hundreds of times. This will lead to a
distribution of summed-statistics, each representing the results of a
statistical test on shuffled data. Intuitively, this distribution
represents what kind of sum-statistics we would expect to get by chance,
if no effect were present (i.e., if the data were just randomly
shuffled).</li>
<li>Compare the cluster-statistics from step (3) to the distribution
found in (6) to obtain a p-value. So, for example, if we get a
distribution of sum-statistics, and 6.4% of the sum-statistics in this
distribution are more extreme the sum-statistic of our cluster, then our
<em>p</em>-value for this cluster is <em>p</em> = .064.</li>
</ol>
<hr>
<p>This analysis has two main advantages over the ones reviewed so
far:</p>
<ol style="list-style-type: decimal">
<li>It naturally controls the false-alarm rate while sacrificing little
sensitivity.</li>
<li>The implementation in eyetrackingR allows you to use this method
with a variety of statistical techniques (<code>t.test</code>,
<code>wilcox.test</code>, <code>(g)lm</code>, and <code>(g)lmer</code>),
so that continuous predictors, covariates, etc. can also be included in
the model being tested. We even provide (experimental) support for using
boot-splines as the test performed at each time bin.</li>
</ol>
<p>To perform this analysis, we first need to set a threshold for our
“first pass,” for which time-bins will be included in clusters. This can
be a source of misconceptions. The <em>size</em> of the initial
threshold you set should be set in a principled way (e.g., don’t run the
cluster analysis, examine the result, then decide you want to use a
different threshold). But perhaps surprisingly, the test controls the
family-wise error rate, even if we don’t choose a threshold that
corresponds to p = .05. This is because the threshold affects both the
first pass and the shuffled data: if we let more time-bins into our
intial clusters, then more time-bins will be let into our shuffled data
as well, and bigger time-clusters will be expected under the null
distribution.</p>
<p>Here, we’ll just set our threshold based on the t-distribution: ~2.06
corresponds to the usual statistic we would use in a t-test for this
sample.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_sub</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">(</span><span class="va">response_window_clean</span><span class="op">$</span><span class="va">ParticipantName</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">threshold_t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">qt</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fl">.05</span><span class="op">/</span><span class="fl">2</span>, </span>
<span>                 df <span class="op">=</span> <span class="va">num_sub</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># pick threshold t based on alpha = .05 two tailed</span></span></code></pre></div>
<p>We can then look for initial clusters:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_timeclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_time_cluster_data.html">make_time_cluster_data</a></span><span class="op">(</span><span class="va">response_time</span>, </span>
<span>                                      test<span class="op">=</span> <span class="st">"t.test"</span>, paired<span class="op">=</span><span class="cn">T</span>,</span>
<span>                                      predictor_column <span class="op">=</span> <span class="st">"Target"</span>, </span>
<span>                                      threshold <span class="op">=</span> <span class="va">threshold_t</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df_timeclust</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"T-Statistic"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divergence_vignette_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">df_timeclust</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Test Type:    t.test </span></span>
<span><span class="co">## Predictor:    Target </span></span>
<span><span class="co">## Formula:  Pair(Prop[Target == "Animate"], Prop[Target == "Inanimate"]) ~      1 </span></span>
<span><span class="co">## Summary of Clusters ======</span></span>
<span><span class="co">##   Cluster Direction SumStatistic StartTime EndTime</span></span>
<span><span class="co">## 1       1  Positive    132.29900     16100   19300</span></span>
<span><span class="co">## 2       2  Positive     42.31067     19400   20800</span></span></code></pre>
<p>The above tells us there are two potential clusters. As described in
the procedure above, eyetrackingR next bootstraps a “null” distribution,
which can be visualized:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clust_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_time_clusters.html">analyze_time_clusters</a></span><span class="op">(</span><span class="va">df_timeclust</span>, within_subj<span class="op">=</span><span class="cn">TRUE</span>, paired<span class="op">=</span><span class="cn">TRUE</span>,quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                        samples<span class="op">=</span><span class="fl">150</span><span class="op">)</span> <span class="co"># in practice, you should use a lot more</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">clust_analysis</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divergence_vignette_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>How can we interpret these results?</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">clust_analysis</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Test Type:    t.test </span></span>
<span><span class="co">## Predictor:    Target </span></span>
<span><span class="co">## Formula:  Pair(Prop[Target == "Animate"], Prop[Target == "Inanimate"]) ~      1 </span></span>
<span><span class="co">## Null Distribution   ====== </span></span>
<span><span class="co">##  Mean:        0.5894 </span></span>
<span><span class="co">##  2.5%:        -21.7784 </span></span>
<span><span class="co">## 97.5%:        24.6837 </span></span>
<span><span class="co">## Summary of Clusters ======</span></span>
<span><span class="co">##   Cluster Direction SumStatistic StartTime EndTime Probability</span></span>
<span><span class="co">## 1       1  Positive    132.29900     16100   19300 0.000000000</span></span>
<span><span class="co">## 2       2  Positive     42.31067     19400   20800 0.006666667</span></span></code></pre>
<p>The probabilities listed above tell us the probability of seeing the
effect of each cluster (or bigger) if the null-hypothesis were true. Of
course, these probabilities aren’t accurate unless we run enough
iterations to get a fuller simulation of the whole null distribution
(we’ve just ommitted this for purposes of speed).</p>
<p>Note that we actually ended up getting virtually identical results to
our initial analysis of sequential time-bins! That’s because the effect
here was quite large; we didn’t have to worry about spuriously
significant time-bins because there probably weren’t any.</p>
<p>Let’s run a quick analysis that does a better job of showing off the
virtues of cluster analysis. We’ll examine the hypothesis that infants
with higher MCDI vocabulary scores have a baseline bias to look at the
animate object. Note that this is different from the hypothesis that
high-vocab infants are likely to look at the trial <em>target</em>; we
are instead examining the unlikely hypothesis that high-vocab infants
have a baseline preference.</p>
<p>This analysis is good for showing off the virtues of cluster analysis
for two reasons. First, the effect is unlikely to be real, but (we will
see that) sequential independent tests at each time-bin give some
false-alarms. Second, this effect can’t be assessed with analyses that
only allow for testing two-level factors (like t-tests), because our
predictor is continuous. EyetrackingR allows us to accomplish this quite
easily by using <code>lm</code> as our test instead of
<code>t-test</code>.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response_time_between</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_time_sequence_data.html">make_time_sequence_data</a></span><span class="op">(</span><span class="va">response_window_clean</span>,</span>
<span>                                  time_bin_size <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                                  predictor_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sex"</span>, <span class="st">"MCDI_Total"</span><span class="op">)</span>,</span>
<span>                                  aois <span class="op">=</span> <span class="st">"Animate"</span>,</span>
<span>                                  summarize_by <span class="op">=</span> <span class="st">"ParticipantName"</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">df_timeclust_between</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_time_cluster_data.html">make_time_cluster_data</a></span><span class="op">(</span><span class="va">response_time_between</span>, </span>
<span>                                      test<span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>                                      predictor_column <span class="op">=</span> <span class="st">"MCDI_Total"</span>, </span>
<span>                                      threshold <span class="op">=</span> <span class="va">threshold_t</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df_timeclust_between</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"T-Statistic"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divergence_vignette_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">df_timeclust_between</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Test Type:    lm </span></span>
<span><span class="co">## Predictor:    MCDI_Total </span></span>
<span><span class="co">## Formula:  Prop ~ MCDI_Total </span></span>
<span><span class="co">## Summary of Clusters ======</span></span>
<span><span class="co">##   Cluster Direction SumStatistic StartTime EndTime</span></span>
<span><span class="co">## 1       1  Negative    -6.766357     16100   16400</span></span></code></pre>
<p>If we used the uncorrected sequential test method, we would get what
appears to be a statistically significant preference for the animate
object among high-vocab children early in the trial. Should we trust
this as a real effect?</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">clust_analysis_between</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_time_clusters.html">analyze_time_clusters</a></span><span class="op">(</span><span class="va">df_timeclust_between</span>, within_subj <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                        samples<span class="op">=</span><span class="fl">150</span><span class="op">)</span> <span class="co"># in practice, you should use a lot more</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">clust_analysis_between</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="divergence_vignette_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">clust_analysis_between</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Test Type:    lm </span></span>
<span><span class="co">## Predictor:    MCDI_Total </span></span>
<span><span class="co">## Formula:  Prop ~ MCDI_Total </span></span>
<span><span class="co">## Null Distribution   ====== </span></span>
<span><span class="co">##  Mean:        -0.2957 </span></span>
<span><span class="co">##  2.5%:        -23.0358 </span></span>
<span><span class="co">## 97.5%:        23.4564 </span></span>
<span><span class="co">## Summary of Clusters ======</span></span>
<span><span class="co">##   Cluster Direction SumStatistic StartTime EndTime Probability</span></span>
<span><span class="co">## 1       1  Negative    -6.766357     16100   16400   0.2933333</span></span></code></pre>
<p>Cluster-analysis (probably correctly) says no: we should expect to
get a divergence at least this large ~%25 of the time under the
null-hypothesis.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Maris, E., Oostenveld, R., (2007). Nonparametric statistical testing
of EEG- and MEG-data. Journal of Neuroscience Methods 164 (1),
177–190.</p>
<p>Wendt, D., Brand, T., &amp; Kollmeier, B. (2014). An Eye-Tracking
Paradigm for Analyzing the Processing Time of Sentences with Different
Linguistic Complexities. PLoS ONE, 9(6), e100186. <a href="https://doi.org/10.1371/journal.pone.0100186.t003" class="external-link uri">https://doi.org/10.1371/journal.pone.0100186.t003</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samuel Forbes, Jacob Dink, Brock Ferguson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
